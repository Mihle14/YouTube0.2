<div class="min-h-screen bg-black text-white flex flex-col items-center px-4 py-10">
  <div class="w-full max-w-3xl">

    <h1 class="text-3xl font-bold mb-6 text-center">Customize Your Channel</h1>

    <%= form_with model: @channel, local: true, html: { class: "space-y-6", multipart: true } do |f| %>
      <div class="bg-[#181818] rounded-xl overflow-hidden border border-gray-700">
        <div id="banner-preview">
          <% if @channel.banner.attached? %>
            <%= image_tag @channel.banner, class: "w-full h-[210px] object-cover" %>
          <% else %>
            <div class="w-full h-[210px] bg-[#272727] flex items-center justify-center text-gray-400">
              No Banner Uploaded
            </div>
          <% end %>
        </div>
        <div class="p-4 flex justify-between items-center">
          <span class="font-medium">Channel Banner</span>
          <label class="bg-red-600 px-4 py-2 rounded-full cursor-pointer hover:bg-red-700 transition text-sm font-semibold">
            Upload Banner
            <%= f.file_field :banner, class: "hidden", onchange: "previewBanner(event)" %>
          </label>
        </div>
      </div>

      <div class="flex items-center gap-5 bg-[#181818] border border-gray-700 rounded-xl p-4">
        <div class="relative">
          <div id="avatar-preview">
            <% if @channel.avatar.attached? %>
              <%= image_tag @channel.avatar, class: "w-24 h-24 rounded-full object-cover border-2 border-gray-600" %>
            <% else %>
              <%= image_tag "avatar.avif", class: "w-24 h-24 rounded-full object-cover border-2 border-gray-600" %>
            <% end %>
          </div>
          <label class="absolute bottom-0 right-0 bg-red-600 w-8 h-8 flex items-center justify-center rounded-full cursor-pointer hover:bg-red-700">
            <i class="fas fa-camera text-xs"></i>
            <%= f.file_field :avatar, class: "hidden", onchange: "previewAvatar(event)" %>
          </label>
        </div>

        <div class="flex-1">
          <div class="mb-2 font-medium text-sm">Channel Name</div>
          <%= f.text_field :name, class: "w-full bg-[#272727] border border-gray-600 rounded-full px-4 py-2 focus:outline-none text-sm" %>
        </div>
      </div>

      <div>
        <div class="mb-2 font-medium text-sm pl-2">Channel Description</div>
        <%= f.text_area :description, rows: 4, class: "w-full bg-[#272727] border border-gray-600 rounded-xl px-4 py-3 focus:outline-none text-sm resize-none" %>
      </div>

      <div class="flex justify-end pt-6 sticky bottom-0 bg-black">
        <%= f.submit "Update Channel",
            class: "bg-red-600 hover:bg-red-700 text-white font-semibold px-6 py-2 rounded-full transition" %>
      </div>

    <% end %>
  </div>
</div>

<script>
  function previewBanner(event) {
    const output = document.getElementById("banner-preview");
    output.innerHTML = `<img src="${URL.createObjectURL(event.target.files[0])}" class="w-full h-[210px] object-cover"/>`;
  }

  function previewAvatar(event) {
    const output = document.getElementById("avatar-preview");
    output.innerHTML = `<img src="${URL.createObjectURL(event.target.files[0])}" class="w-24 h-24 rounded-full object-cover border-2 border-gray-600"/>`;
  }
</script>
